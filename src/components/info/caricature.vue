<template>
    <div class="wrap">
        <van-overlay :show="show" >
            <div>
                <svg t="1578638420808" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="833" width="48" height="48"><path d="M511.504516 0C238.129548 0 16.516129 222.174968 16.516129 496.243613 16.516129 770.312258 238.129548 992.487226 511.504516 992.487226 784.879484 992.487226 1006.492903 770.312258 1006.492903 496.243613 1006.492903 222.174968 784.912516 0 511.504516 0L511.504516 0ZM511.504516 942.839742C265.447226 942.839742 65.998452 742.895484 65.998452 496.210581 65.998452 249.525677 265.447226 49.581419 511.504516 49.581419 757.561806 49.581419 957.010581 249.525677 957.010581 496.210581 957.010581 742.895484 757.561806 942.839742 511.504516 942.839742L511.504516 942.839742Z" p-id="834" fill="#dd5645"></path><path d="M514.708645 281.963355C463.541677 281.963355 412.473806 301.815742 373.46271 341.520516 334.517677 381.192258 314.962581 433.251097 314.962581 485.243871 314.962581 537.236645 334.484645 589.295484 373.46271 628.967226 412.473806 668.672 463.541677 688.524387 514.708645 688.524387 565.809548 688.524387 616.877419 668.672 655.888516 628.967226 694.833548 589.295484 714.355613 537.236645 714.355613 485.243871 714.355613 433.251097 694.833548 381.192258 655.888516 341.520516 616.877419 301.815742 565.809548 281.963355 514.708645 281.963355L514.708645 281.963355ZM529.044645 329.562839C532.380903 316.944516 545.197419 309.380129 557.650581 312.782452 570.136774 316.184774 577.469935 329.199484 574.133677 341.850839 570.797419 354.535226 558.046968 362.099613 545.593806 358.69729 533.107613 355.294968 525.708387 342.280258 529.044645 329.562839L529.044645 329.562839ZM373.198452 546.617806C360.811355 550.053161 347.994839 542.554839 344.658581 529.870452 341.322323 517.186065 348.655484 504.138323 361.141677 500.736 373.627871 497.36671 386.411355 504.865032 389.747613 517.582452 393.083871 530.233806 385.684645 543.215484 373.198452 546.617806L373.198452 546.617806ZM389.615484 392.291097C380.498581 383.009032 380.498581 367.979355 389.615484 358.69729 398.765419 349.415226 413.497806 349.415226 422.61471 358.69729 431.698581 367.979355 431.698581 383.009032 422.61471 392.291097 413.497806 401.606194 398.732387 401.606194 389.615484 392.291097L389.615484 392.291097ZM496.309677 638.282323C492.973419 650.900645 480.156903 658.465032 467.769806 655.06271 455.283613 651.660387 447.884387 638.645677 451.220645 625.994323 454.556903 613.309935 467.373419 605.745548 479.826581 609.147871 492.24671 612.550194 499.645935 625.564903 496.309677 638.282323L496.309677 638.282323ZM444.085677 553.818839C406.197677 515.171097 406.197677 452.674065 444.085677 414.092387 481.973677 375.543742 543.44671 375.543742 581.33471 414.092387 619.22271 452.674065 619.22271 515.204129 581.33471 553.818839 543.44671 592.367484 481.973677 592.367484 444.085677 553.818839L444.085677 553.818839ZM635.837935 609.147871C626.688 618.396903 611.889548 618.396903 602.83871 609.147871 593.721806 599.865806 593.721806 584.803097 602.83871 575.554065 611.922581 566.238968 626.721032 566.238968 635.837935 575.554065 644.888774 584.803097 644.888774 599.832774 635.837935 609.147871L635.837935 609.147871ZM680.761806 437.97471C684.098065 450.692129 676.698839 463.706839 664.212645 467.109161 651.825548 470.478452 639.009032 462.980129 635.672774 450.26271 632.336516 437.611355 639.735742 424.563613 652.155871 421.16129 664.642065 417.825032 677.425548 425.290323 680.761806 437.97471L680.761806 437.97471Z" p-id="835" fill="#dd5645"></path><path d="M210.085161 197.400774 231.754323 339.406452 268.354065 333.724903 246.684903 191.686194 210.085161 197.400774Z" p-id="836" fill="#dd5645"></path><path d="M398.005677 863.793548 421.227355 893.22529 530.465032 803.740903 507.243355 774.309161 398.005677 863.793548Z" p-id="837" fill="#dd5645"></path><path d="M777.546323 308.983742 764.135226 344.163097 894.117161 395.429161 907.528258 360.249806 777.546323 308.983742Z" p-id="838" fill="#dd5645"></path><path d="M115.513806 606.637419 246.817032 658.432 260.228129 623.252645 128.924903 571.458065 115.513806 606.637419Z" p-id="839" fill="#dd5645"></path><path d="M627.612903 103.853419 604.424258 74.421677 498.654968 161.06529 521.843613 190.464 627.612903 103.853419Z" p-id="840" fill="#dd5645"></path><path d="M756.934194 636.20129 778.206968 776.125935 814.905806 770.34529 793.6 630.387613 756.934194 636.20129Z" p-id="841" fill="#dd5645"></path></svg>
                <span>漫画加载中</span>
            </div>
        </van-overlay>
        <hea></hea>
        <van-image v-for="(item, num) in list" :key="num" lazy-load :src="item.img" @error="err"/>
        <div class="more">
            <svg @click="geold" t="1578400697409" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2349" width="48" height="48"><path d="M277.632 764.672c-9.088-9.088-9.088-24.064 0-33.152L908.032 101.12c9.088-9.088 24.064-9.088 33.152 0 9.088 9.088 9.088 24.064 0 33.152L310.656 764.672c-9.088 9.088-23.936 9.088-33.024 0z" fill="#515151" p-id="2350"></path><path d="M268.288 838.016c7.808-11.008 16.384-25.088 21.12-36.608 1.024-0.384 2.048-0.768 2.944-1.408 2.176-1.536 4.224-3.2 6.144-5.12L973.824 119.552l0.128-0.128L993.408 99.84c8.704-8.704 12.928-20.224 12.544-31.616 3.072-1.536 5.888-3.456 8.32-5.888 12.288-12.288 12.288-32.256 0-44.672l-6.4-6.4c-5.888-5.888-13.824-9.216-22.272-9.216s-16.384 3.328-22.272 9.216c-2.432 2.432-4.48 5.248-5.888 8.32-11.392-0.256-22.912 3.84-31.616 12.544L906.24 51.84l-0.128 0.128-643.2 643.2c-1.92 1.152-3.456 2.688-4.608 4.608l-27.392 27.392c-0.512 0.512-0.896 0.896-1.28 1.408-3.072 0.768-5.12 1.536-5.76 1.792-5.376 1.92-82.432 31.36-122.24 106.24-36.736 68.864-75.52 104.192-91.392 107.392-5.504 1.152-9.6 5.632-10.112 11.136-0.384 3.84 1.024 7.68 3.712 10.24 1.152 1.152 2.432 2.048 3.968 2.688 0.512 0.256 2.432 1.024 5.632 2.048 1.408 0.64 3.456 1.28 6.016 1.792 25.216 6.528 88.064 14.08 159.104-41.984 46.72-36.992 74.624-70.4 89.728-91.904z m11.008-97.152c-4.864-4.992-10.24-8.448-15.488-10.624l12.672-12.672c1.024-0.128 1.92-0.256 2.944-0.256 6.016 0 11.648 2.304 15.872 6.528l6.016 6.016c5.376 5.376 7.552 12.928 6.016 20.352l-14.08 14.08c-1.92-6.784-5.76-14.848-13.952-23.424zM968.96 50.176l6.528 6.528c1.792 1.792 3.072 3.712 3.84 5.888v0.128c2.56 6.4 1.28 14.08-3.968 19.2l-0.128 0.128c-2.304-5.632-5.76-11.008-10.368-15.488l-6.016-6.016c-4.48-4.48-9.728-7.936-15.36-10.368l0.128-0.128c7.04-6.784 18.432-6.784 25.344 0.128z m-47.36 22.272c1.28-0.256 2.432-0.384 3.712-0.384 6.016 0 11.648 2.304 15.872 6.528l6.016 6.016c5.12 5.12 7.424 12.416 6.272 19.456L329.6 727.808c-2.304-5.888-5.888-11.264-10.496-15.872l-6.016-6.016c-4.352-4.352-9.472-7.808-14.976-10.112L921.6 72.448z m64.128-44.928c1.024 0 2.816 0.256 4.352 1.792l6.4 6.4c2.048 2.048 2.304 5.248 0.896 7.68-1.152-1.536-2.432-3.072-3.84-4.48l-6.528-6.528c-1.408-1.408-2.944-2.688-4.48-3.84 1.152-0.896 2.432-1.024 3.2-1.024zM162.816 909.952C135.808 931.328 110.464 942.08 88.832 947.2c11.392-7.808 24.32-17.92 38.656-30.976 5.248-4.736 5.632-12.672 0.896-17.92s-12.672-5.632-17.92-0.896c-16.64 15.104-30.592 25.6-41.984 33.024 18.816-20.992 38.272-49.28 55.552-81.792 30.208-56.832 88.576-87.424 108.544-94.336 0.128 0 0.384-0.128 0.512-0.128 0 0 1.024-0.384 2.688-0.768 1.792 0.128 3.712-0.256 5.376-0.896 5.888-0.64 13.824 0 19.584 5.888 0.128 0.128 0.128 0.256 0.256 0.256 8.96 9.344 8.32 14.464 7.552 20.864-0.256 2.176-0.512 4.352-0.512 6.784-1.92 8.704-25.728 60.8-105.216 123.648z" fill="#515151" p-id="2351"></path></svg>
            <svg @click="getnext" t="1578385621435" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1630" width="48" height="48"><path d="M116.992 151.04H162.56v642.176H116.992zM939.52 192.384h52.864v650.496H939.52zM847.36 192.384h52.864v650.496H847.36zM755.2 192.384h52.864v650.496H755.2zM663.04 192.384h52.864v650.496H663.04zM570.88 192.384h52.864v650.496H570.88zM478.72 192.384h52.864v650.496H478.72zM386.56 192.384h52.864v650.496H386.56zM294.4 192.384h52.864v650.496H294.4zM255.104 842.88L202.24 801.664V146.816l52.864 45.568zM16.896 842.88l52.864-41.216V146.816l-52.864 45.568z" fill="#55AEFF" p-id="1631"></path><path d="M1008.512 828.16h-1.28V206.976h0.128c8.192 0 14.72-6.656 14.72-14.72s-6.656-14.72-14.72-14.72h-0.128V113.28c0-15.616-12.672-28.416-28.416-28.416H952.32c-15.616 0-28.416 12.672-28.416 28.416v64.256h-8.448V113.28c0-15.616-12.672-28.416-28.416-28.416h-26.496c-15.616 0-28.416 12.672-28.416 28.416v64.256h-8.448V113.28c0-15.616-12.672-28.416-28.416-28.416h-26.496c-15.616 0-28.416 12.672-28.416 28.416v64.256h-8.448V113.28c0-15.616-12.672-28.416-28.416-28.416H677.12c-15.616 0-28.416 12.672-28.416 28.416v64.256h-8.448V113.28c0-15.616-12.672-28.416-28.416-28.416h-26.496c-15.616 0-28.416 12.672-28.416 28.416v64.256h-8.448V113.28c0-15.616-12.672-28.416-28.416-28.416h-26.496c-15.616 0-28.416 12.672-28.416 28.416v64.256h-8.448V113.28c0-15.616-12.672-28.416-28.416-28.416H401.92c-15.616 0-28.416 12.672-28.416 28.416v64.256h-8.448V113.28c0-15.616-12.672-28.416-28.416-28.416h-26.496c-15.616 0-28.416 12.672-28.416 28.416v64.256H270.08l0.128-65.28c0-12.8-8.832-27.136-21.12-34.304l-26.752-15.488c-8.704-4.992-17.92-5.504-25.216-1.28-6.784 3.84-10.624 11.008-10.624 19.584l-0.128 55.424h-9.216V71.168c0-15.616-12.672-28.416-28.416-28.416H122.368c-15.616 0-28.416 12.672-28.416 28.416v65.152H84.48V80.896c0-8.576-3.968-15.744-10.624-19.584-7.296-4.224-16.512-3.712-25.216 1.28L21.888 78.08C9.6 85.12 0.768 99.584 0.768 112.256l1.408 787.328V911.616c0 12.8 8.832 27.136 21.12 34.304L49.92 961.408c4.736 2.816 9.728 4.096 14.336 4.096 3.84 0 7.552-0.896 10.88-2.816 6.784-3.968 10.624-11.008 10.624-19.584l0.128-73.984c0-0.512 0-1.024-0.128-1.664v-51.072h8.192v136.448c0 15.616 12.672 28.416 28.416 28.416h26.496c15.616 0 28.416-12.672 28.416-28.416V816.384h8.064l-0.128 52.608V873.344l0.128 69.632c0 8.576 3.968 15.744 10.752 19.584 3.328 1.92 7.04 2.816 10.88 2.816 4.608 0 9.6-1.408 14.336-4.096l26.752-15.488c12.16-7.04 21.12-21.504 21.12-34.176v-13.824c0-0.512 0-1.152-0.128-1.664l0.128-38.528h12.8v55.424c0 15.616 12.672 28.416 28.416 28.416h26.496c15.616 0 28.416-12.672 28.416-28.416V857.6h8.448v55.424c0 15.616 12.672 28.416 28.416 28.416h26.496c15.616 0 28.416-12.672 28.416-28.416V857.6h8.448v55.424c0 15.616 12.672 28.416 28.416 28.416h26.496c15.616 0 28.416-12.672 28.416-28.416V857.6h8.448v55.424c0 15.616 12.672 28.416 28.416 28.416h26.496c15.616 0 28.416-12.672 28.416-28.416V857.6h8.448v55.424c0 15.616 12.672 28.416 28.416 28.416H704c15.616 0 28.416-12.672 28.416-28.416V857.6h8.448v55.424c0 15.616 12.672 28.416 28.416 28.416h26.496c15.616 0 28.416-12.672 28.416-28.416V857.6h8.448v55.424c0 15.616 12.672 28.416 28.416 28.416H887.04c15.616 0 28.416-12.672 28.416-28.416V857.6h8.448v55.424c0 15.616 12.672 28.416 28.416 28.416h26.496c15.616 0 28.416-12.672 28.416-28.416V857.6h1.28c8.192 0 14.72-6.656 14.72-14.72s-6.656-14.72-14.72-14.72z m-30.848 0h-24.32V206.976h24.32V828.16z m-24.32-713.728h24.32v63.232h-24.32V114.432z m-91.648 0h24.32v63.232h-24.32V114.432z m24.32 92.544V828.16h-24.32V206.976h24.32z m-116.096-92.544h24.32v63.232h-24.32V114.432z m24.32 92.544V828.16h-24.32V206.976h24.32z m-115.968-92.544h24.32v63.232h-24.32V114.432z m24.32 92.544V828.16h-24.32V206.976h24.32z m-116.096-92.544h24.32v63.232h-24.32V114.432z m24.32 92.544V828.16h-24.32V206.976h24.32z m-115.968-92.544h24.32v63.232h-24.32V114.432z m24.192 92.544V828.16h-24.32V206.976h24.32z m-115.968-92.544h24.32v63.232h-24.32V114.432z m24.32 92.544V828.16h-24.32V206.976h24.32z m-115.968-92.544h24.32v63.232h-24.32V114.432z m24.192 92.544V828.16h-24.32V206.976h24.32z m-120.832 664.192l0.128-40.96 24.704 19.584-0.128 42.88-18.432-10.624c-3.456-2.048-6.272-6.912-6.4-8.704l0.128-2.176z m0.128-78.464l1.024-611.328L240.64 200.96l-1.024 611.328-24.704-19.584z m19.584-689.152c3.456 2.048 6.272 6.912 6.4 8.704l-0.128 51.2-24.704-19.584 0.128-50.944 18.304 10.624zM123.52 72.32h24.32v64h-24.32v-64z m24.32 93.44v621.184h-24.32V165.76h24.32zM56.448 873.344c-0.128 1.792-2.816 6.656-6.4 8.704l-18.432 10.624-0.128-44.416L56.32 830.464l0.128 42.88z m-0.128-79.104l-24.832 17.792-1.024-614.4 24.832-17.792 1.024 614.4zM36.608 103.552L55.04 92.928l0.128 50.56L30.336 161.28l-0.128-49.024c0.128-1.792 2.944-6.656 6.4-8.704z m3.584 818.176l16.128-9.344v18.688l-16.128-9.344zM85.76 786.944l-1.024-621.184h9.344v621.184H85.76z m37.76 164.736v-52.352h24.32v52.352h-24.32z m24.32-81.792h-24.32v-53.504h24.32v53.504z m29.44-82.944V165.76h9.216l-1.024 621.184h-8.192z m37.632 144.128v-18.688l16.128 9.344-16.128 9.344z m54.144-102.912l1.024-621.184h11.648V828.16h-12.672z m66.56 83.84h-24.32V857.6h24.32v54.4z m29.568-83.84V206.976h8.448V828.16h-8.448z m62.208 83.84h-24.32V857.6h24.32v54.4z m29.44-83.84V206.976h8.448V828.16h-8.448z m62.208 83.84h-24.32V857.6h24.32v54.4z m29.568-83.84V206.976h8.448V828.16h-8.448z m62.208 83.84h-24.32V857.6h24.32v54.4z m29.44-83.84V206.976h8.448V828.16h-8.448z m62.336 83.84h-24.32V857.6h24.32v54.4z m29.44-83.84V206.976h8.448V828.16h-8.448z m62.208 83.84h-24.32V857.6h24.32v54.4z m29.44-83.84V206.976h8.448V828.16h-8.448z m62.336 83.84h-24.32V857.6h24.32v54.4z m29.44-83.84V206.976h8.448V828.16h-8.448z m62.208 83.84h-24.32V857.6h24.32v54.4z" fill="#002C5B" p-id="1632"></path></svg>
        </div>
    </div>
</template>
<script>
import { Toast } from 'vant';
import hea from '../tool/return.vue';
export default {
    data() {
        return {
            url:this.$route.query.url1,
            stat_url:this.$route.query.url1,
            list:[],
            show:true,
            shelf:this.$route.query.shelf,
            name:this.$route.query.name,
        }
    },
    created() {
        this.getinfo();
    },
    beforeDestroy() {
        this.ifshelf();
    },
    methods: {
        getinfo(){
            this.$axios.get('http://api.pingcc.cn/?mhurl2=' + this.url).then((reslut)=>{
                if(reslut.data.code == 0){
                    this.list = reslut.data.list;
                    this.show = false;
                }else if(reslut.data.code == 1){
                    this.url = this.stat_url;
                    this.show = false;
                    Toast({
                        message: '访问数据时,我们迷路了',
                        icon: 'close'
                    });
                }
            }).catch((err)=>{
                this.url = this.stat_url;
                this.show = false;
                 Toast({
                    message: '访问数据时,它已经远走高飞了',
                    icon: 'question-o'
                });
            });
        },
        getnext(){
            // mhz/211692/644915.html
            let c = this.url.split('/')[this.url.split('/').length-1];
            let a = parseInt(c.split('.')[0]) +1;
            let d = '';
            for (let i = 1; i <= this.url.split('/').length-1; i++) {
               d += this.url.split('/')[i-1]+'/'
            }
            this.url  = d + a + '.html';
            this.getinfo();
            window.scrollTo(0,0);
        },
        geold(){
            let c = this.url.split('/')[this.url.split('/').length-1];
            let a = parseInt(c.split('.')[0]) - 1;
            let d = '';
            for (let i = 1; i <= this.url.split('/').length-1; i++) {
               d += this.url.split('/')[i-1]+'/'
            }
            this.url  = d + a + '.html';
            this.getinfo();
            window.scrollTo(0,0);
        },
        ifshelf(){
            if (this.shelf == 'true') {
                this.$axios({
                    method:'get',
                    url:`${this.$store.state.url}user/upcart`,
                    params:{
                        name:this.name,
                        email:JSON.parse(this.$store.state.user).email,
                        last:this.url,
                    }
                }).then((reslut)=>{
                    if(reslut.data.code == 0){
                        Toast({
                            message: '保存漫画章节成功',
                            icon: 'passed'
                        });
                    }else if(reslut.data.code == 1){
                        Toast({
                            message: '保存漫画章节失败',
                            icon: 'close'
                        });
                        this.show = false;
                    }
                }).catch((err)=>{
                    Toast({
                        message: '服务器故障',
                        icon: 'question-o'
                    });
                    this.show = false;
                });

            }else{
                return
            }
        },
        err(){
            Toast({
                message: '漫画加载失败，请换一个',
                icon: 'close'
            });
        }
    },
    components:{
        hea
    }
}
</script>
<style lang="less" scoped>
h3{
    padding: 10px 0;
}
.more{
    text-align: center;
}
.wrap{
    padding: 10px;
    background-color: #fff;
    .van-overlay{
        div{
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            color: #fff;
        }
    }
    p{
    color: #000;
    word-spacing: 1px;
}
}
</style>